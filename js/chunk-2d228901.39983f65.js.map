{"version":3,"sources":["webpack:///./src/views/UserEdit.vue?dd13","webpack:///src/views/UserEdit.vue","webpack:///./src/views/UserEdit.vue?61a0","webpack:///./src/views/UserEdit.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","directives","name","rawName","value","isLoading","expression","staticClass","on","$event","stopPropagation","preventDefault","submitHandler","attrs","_v","profile","domProps","target","composing","$set","image","_e","fileChangeHandler","isProcessing","$router","back","staticRenderFns","computed","mixins","data","paramsId","id","watch","currentUser","$route","params","setUser","methods","push","component"],"mappings":"uHAAA,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,WAAW,CAAC,CAACC,KAAK,OAAOC,QAAQ,SAASC,OAAQT,EAAIU,UAAWC,WAAW,eAAeC,YAAY,kBAAkB,CAACR,EAAG,OAAO,CAACS,GAAG,CAAC,OAAS,SAASC,GAAyD,OAAjDA,EAAOC,kBAAkBD,EAAOE,iBAAwBhB,EAAIiB,cAAcH,MAAW,CAACV,EAAG,MAAM,CAACQ,YAAY,cAAc,CAACR,EAAG,QAAQ,CAACc,MAAM,CAAC,IAAM,SAAS,CAAClB,EAAImB,GAAG,UAAUf,EAAG,QAAQ,CAACE,WAAW,CAAC,CAACC,KAAK,QAAQC,QAAQ,UAAUC,MAAOT,EAAIoB,QAAY,KAAET,WAAW,iBAAiBC,YAAY,eAAeM,MAAM,CAAC,GAAK,OAAO,KAAO,OAAO,KAAO,OAAO,SAAW,IAAIG,SAAS,CAAC,MAASrB,EAAIoB,QAAY,MAAGP,GAAG,CAAC,MAAQ,SAASC,GAAWA,EAAOQ,OAAOC,WAAqBvB,EAAIwB,KAAKxB,EAAIoB,QAAS,OAAQN,EAAOQ,OAAOb,aAAaL,EAAG,MAAM,CAACQ,YAAY,cAAc,CAACR,EAAG,QAAQ,CAACc,MAAM,CAAC,IAAM,UAAU,CAAClB,EAAImB,GAAG,WAAYnB,EAAIoB,QAAa,MAAEhB,EAAG,MAAM,CAACQ,YAAY,eAAeM,MAAM,CAAC,MAAQ,MAAM,OAAS,MAAM,IAAMlB,EAAIoB,QAAQK,SAASzB,EAAI0B,KAAKtB,EAAG,QAAQ,CAACQ,YAAY,oBAAoBM,MAAM,CAAC,GAAK,QAAQ,KAAO,OAAO,KAAO,QAAQ,OAAS,WAAWL,GAAG,CAAC,OAASb,EAAI2B,uBAAuBvB,EAAG,SAAS,CAACQ,YAAY,kBAAkBM,MAAM,CAAC,SAAWlB,EAAI4B,aAAa,KAAO,WAAW,CAAC5B,EAAImB,GAAG,cAAcf,EAAG,SAAS,CAACQ,YAAY,eAAeM,MAAM,CAAC,KAAO,UAAUL,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAOd,EAAI6B,QAAQC,UAAU,CAAC9B,EAAImB,GAAG,aAC74CY,EAAkB,G,8FCyCtB,GACEC,SAAU,OAAZ,OAAY,CAAZ,GACA,iCAEEC,OAAQ,CAAC,EAAX,MACEC,KALF,WAMI,MAAO,CACLN,cAAc,EACdlB,WAAW,EACXyB,SAAU,KACVf,QAAS,CACPgB,IAAK,EACL7B,KAAM,GACNkB,MAAO,MAIbY,MAAO,CACLC,YADJ,SACA,GACMrC,KAAKkC,SAAWlC,KAAKsC,OAAOC,OAAOJ,GACnCnC,KAAKwC,YAGTC,QAAS,CACPD,QADJ,SACA,GACM,GAAKxC,KAAKqC,YAAYF,GAAtB,CAGA,IAAKnC,KAAKkC,YAAclC,KAAKqC,YAAYF,GACvC,OAAOnC,KAAK4B,QAAQc,KAAK,CAAjC,mBALA,MAOA,mBAPA,EAOA,KAPA,EAOA,OAPA,EAOA,MACM1C,KAAKmB,QAAU,CACbgB,GAAR,EACQ7B,KAAR,EACQkB,MAAR,GAEMxB,KAAKS,WAAY,IAEnB,cAhBJ,SAgBA,mLAEA,kBACA,yBACA,eAJA,uBAKA,aACA,eACA,iBAEA,kCATA,iCAYA,mBAZA,UAaA,iCAbA,oBAaA,EAbA,EAaA,KACA,wBAdA,uBAcA,qBAdA,QAeA,aACA,eACA,qBAEA,kBAnBA,qDAqBA,kBACA,oBACA,aACA,aACA,wBAzBA,+DCjFkV,I,YCO9UkC,EAAY,eACd,EACA7C,EACAgC,GACA,EACA,KACA,KACA,MAIa,aAAAa,E","file":"js/chunk-2d228901.39983f65.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(!_vm.isLoading),expression:\"!isLoading\"}],staticClass:\"container py-5\"},[_c('form',{on:{\"submit\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.submitHandler($event)}}},[_c('div',{staticClass:\"form-group\"},[_c('label',{attrs:{\"for\":\"name\"}},[_vm._v(\"Name\")]),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.profile.name),expression:\"profile.name\"}],staticClass:\"form-control\",attrs:{\"id\":\"name\",\"type\":\"text\",\"name\":\"name\",\"required\":\"\"},domProps:{\"value\":(_vm.profile.name)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.$set(_vm.profile, \"name\", $event.target.value)}}})]),_c('div',{staticClass:\"form-group\"},[_c('label',{attrs:{\"for\":\"image\"}},[_vm._v(\"Image\")]),(_vm.profile.image)?_c('img',{staticClass:\"d-block mb-4\",attrs:{\"width\":\"100\",\"height\":\"100\",\"src\":_vm.profile.image}}):_vm._e(),_c('input',{staticClass:\"form-control-file\",attrs:{\"id\":\"image\",\"type\":\"file\",\"name\":\"image\",\"accept\":\"image/*\"},on:{\"change\":_vm.fileChangeHandler}})]),_c('button',{staticClass:\"btn btn-primary\",attrs:{\"disabled\":_vm.isProcessing,\"type\":\"submit\"}},[_vm._v(\"Submit\")])]),_c('button',{staticClass:\"btn btn-link\",attrs:{\"type\":\"button\"},on:{\"click\":function($event){return _vm.$router.back()}}},[_vm._v(\"回上一頁\")])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template lang=\"pug\">\r\n.container.py-5(v-show=\"!isLoading\")\r\n  form(@submit.stop.prevent=\"submitHandler\")\r\n    .form-group\r\n      label(for=\"name\") Name\r\n      input#name.form-control(\r\n        v-model=\"profile.name\"\r\n        type=\"text\"\r\n        name=\"name\"\r\n        required\r\n      )\r\n    .form-group\r\n      label(for=\"image\") Image\r\n      img.d-block.mb-4(\r\n        width=\"100\"\r\n        height=\"100\"\r\n        v-if=\"profile.image\"\r\n        :src=\"profile.image\"\r\n      )\r\n      input#image.form-control-file(\r\n        @change=\"fileChangeHandler\"\r\n        type=\"file\"\r\n        name=\"image\"\r\n        accept=\"image/*\"\r\n      )\r\n    button.btn.btn-primary(\r\n      :disabled=\"isProcessing\"\r\n      type=\"submit\"\r\n      ) Submit\r\n\r\n  button.btn.btn-link(\r\n    type=\"button\"\r\n    @click=\"$router.back()\"\r\n  ) 回上一頁\r\n\r\n</template>\r\n\r\n<script>\r\nimport { fileChangeHandler } from '../utils/mixins'\r\nimport { mapState } from 'vuex'\r\nimport usersAPI from '../apis/users'\r\nimport { Toast } from '../utils/helpers'\r\nexport default {\r\n  computed: {\r\n    ...mapState(['currentUser'])\r\n  },\r\n  mixins: [fileChangeHandler],\r\n  data () {\r\n    return {\r\n      isProcessing: false,\r\n      isLoading: true,\r\n      paramsId: null,\r\n      profile: {\r\n        id: -1,\r\n        name: '',\r\n        image: ''\r\n      }\r\n    }\r\n  },\r\n  watch: {\r\n    currentUser (nv) {\r\n      this.paramsId = this.$route.params.id\r\n      this.setUser()\r\n    }\r\n  },\r\n  methods: {\r\n    setUser (userId) {\r\n      if (!this.currentUser.id) {\r\n        return\r\n      }\r\n      if (+this.paramsId !== +this.currentUser.id) {\r\n        return this.$router.push({ name: 'not-found' })\r\n      }\r\n      const { id, name, image } = this.currentUser\r\n      this.profile = {\r\n        id,\r\n        name,\r\n        image\r\n      }\r\n      this.isLoading = false\r\n    },\r\n    async submitHandler (e) {\r\n      try {\r\n        this.isProcessing = true\r\n        const payload = new FormData(e.target)\r\n        if (!this.profile.name) {\r\n          Toast.fire({\r\n            icon: 'warning',\r\n            title: '姓名請勿空白'\r\n          })\r\n          this.profile.name = this.currentUser.name\r\n          return\r\n        }\r\n        const userId = this.currentUser.id\r\n        const { data } = await usersAPI.put({ userId, payload })\r\n        if (status.status === 'error') throw new Error(data.message)\r\n        Toast.fire({\r\n          icon: 'success',\r\n          title: '使用者資料已成功更新'\r\n        })\r\n        this.isProcessing = false\r\n      } catch (err) {\r\n        this.isProcessing = false\r\n        console.error(err)\r\n        Toast.fire({\r\n          icon: 'error',\r\n          title: '無法跟新使用者資料，請稍後'\r\n        })\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--11-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./UserEdit.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--11-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./UserEdit.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./UserEdit.vue?vue&type=template&id=54d4d822&lang=pug&\"\nimport script from \"./UserEdit.vue?vue&type=script&lang=js&\"\nexport * from \"./UserEdit.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}